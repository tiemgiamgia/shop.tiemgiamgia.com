---
export const prerender = false;
const { slug } = Astro.params;
const env = Astro.locals.runtime.env;

/* ðŸ”¥ Load homepage slug list */
const homepageSlugs = JSON.parse(
  await env.PRODUCTS.get("homepage")
);

/* ðŸ”¥ Load products song song */
const products = await Promise.all(
  homepageSlugs.map(async slug => {
    const data = await env.PRODUCTS.get(`product:${slug}`);
    return JSON.parse(data);
  })
);
---

<h1>Sáº£n pháº©m má»›i</h1>

<div class="grid">
  {products.map(p => (
    <a href={`/${p.slug}/`} class="card">
      <img src={p.image} alt={p.title} />
      <div class="title">{p.title}</div>
      <div class="price">
        {Number(p.price).toLocaleString("vi-VN")}â‚«
      </div>
    </a>
  ))}
</div>